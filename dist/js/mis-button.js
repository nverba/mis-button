(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/* global MISbtn */

"use strict";

(function () {
	'use strict';

	document.cookie = "setCookie=true,path=/;domain=components.makeitsocial.com";
	function testCookie() {
		document.cookie = "testcookie";
		return document.cookie.indexOf("testcookie") != -1;
	}
	alert('Button cookie set - ' + testCookie());
	console.log('Setting button session cookie');

	var popup = "\n\t\t<div class=\"misFrame\">\n\t\t\t<div class=\"draghandle\">\n\t\t\t\t<div class=\"misIco misMin\"></div>\n\t\t\t</div>\n\t\t</div>\n\t  <iframe class=\"MiS_PopUp\" src=\"\"></iframe>\n\t";

	var sprite = "<div class=\"misBtnFill\"><div class=\"misIco misMax\"></div></div>";
	var buttons = document.getElementsByClassName("makeitsocial-button");
	var isMobile = false; // navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i);

	// Create & append the container for opened, minimised popups.
	var minimised = document.createElement('div');
	minimised.className = "misMinimised";
	document.body.appendChild(minimised);

	// DragCanvas isolates the popups from any underlying iframes that can capture drop events, a drag event removes the { pointer-events: none } class property.
	var dragcanvas = document.createElement('div');
	dragcanvas.className = "dragCanvas";
	document.body.appendChild(dragcanvas);

	window.MISbtn = {
		register: function register() {

			var buttons = document.getElementsByClassName("makeitsocial-button");
			for (var i = 0; i < buttons.length; i++) {
				var button = buttons[i];
				if (button.getAttribute('MisBtnReg')) {
					return;
				}
				console.log('register listener', button);
				createButton(buttons[i]);
				button.setAttribute('MisBtnReg', true);
			}
		},
		url: 'https://popup.makeitsocial.com/'
	};

	function createButton(button) {

		var active = false;
		var pid = button.getAttribute('data-pid');
		var coords = [window.innerWidth / 2 - 200, 20];
		var offset = [0, 0];

		var container = document.createElement('div');

		container.innerHTML = popup;
		container.setAttribute('draggable', 'true');
		container.setAttribute('ondragstart', "event.dataTransfer.setData('text/plain', 'This text may be dragged')"); // firefox data workaround
		container.className = "misCover";

		var loader = container.getElementsByClassName('misSpinner')[0];
		var iframe = container.getElementsByClassName('MiS_PopUp')[0];
		var minimi = container.getElementsByClassName('misMin')[0];
		var cachedPos = undefined;
		var isMinimised = undefined;

		var maximise = document.createElement('button');
		maximise.className = "misBtn";
		maximise.innerHTML = sprite;
		minimised.appendChild(maximise);

		container.addEventListener("dragend", function (event) {
			dragcanvas.className = "dragCanvas";
			updatePos(coords);
		}, false);

		container.addEventListener("dragstart", function (event) {
			dragcanvas.className = "dragCanvas activeDrag";
			offset = [event.offsetX, event.offsetY];
		}, false);

		dragcanvas.addEventListener("dragover", function (event) {
			event.preventDefault();
			coords = [event.clientX - offset[0], event.clientY - offset[1]];
		}, false);

		dragcanvas.addEventListener("drop", function (event) {
			event.preventDefault();
		}, false);

		function updatePos(c) {
			container.style.left = c[0] + 'px';
			container.style.top = c[1] + 'px';
		}

		function launchPopup(e) {

			if (isMobile) {
				window.location.href = MISbtn.url + "#/setup?pid=" + pid;
				return;
			}

			// Open only one popup per button;
			if (active) {
				if (isMinimised) {
					maximisePopup();
				}
				return;
			}

			dragcanvas.appendChild(container);
			updatePos([window.innerWidth / 2 - 200, 20]);
			active = true;

			// iframe.onload = function(e) {
			// 	// Give 1s to let page render with product details
			// 	setTimeout(function() {
			// 		loader.style.display = "none";
			// 		iframe.style.display = "block";
			// 	}, 1000);
			// };

			function minimisePopup() {
				cachedPos = [container.offsetLeft, container.offsetTop];
				container.className = "misCover misMoveMin misAnim";
				maximise.className = "misBtn mimimised";
				updatePos([document.body.offsetWidth - 300, window.innerHeight - 100]);
				isMinimised = true;
			}

			function maximisePopup() {
				container.className = "misCover misAnim";
				maximise.className = "misBtn";
				updatePos(cachedPos);
				isMinimised = false;
				setTimeout(function () {
					container.className = "misCover";
				}, 500);
			}

			function receiveMessage(event) {
				// This check is essential to avoid xss, this feature populates the maximise button text
				if (event.origin !== "https://popup-sandbox.herokuapp.com" && event.origin !== "https://popup.makeitsocial.com") {
					return;
				}
				var data = JSON.parse(event.data);
				if (data.pid === pid) {
					maximise.appendChild(document.createTextNode(data.name));
				}
			}

			window.addEventListener("message", receiveMessage, false);
			maximise.addEventListener('click', maximisePopup);
			minimi.addEventListener('click', minimisePopup);
			// used for local testing
			// iframe.setAttribute('src', "http://127.0.0.1:8080/#/setup?pid=" + pid);  
			iframe.setAttribute('src', MISbtn.url + "#/setup?pid=" + pid);
		}

		button.addEventListener('click', launchPopup);
	}
})();

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvaG9tZS9udmVyYmEvY29kZS9wb2x5bWVyL3J1YmJlci1lbGVtZW50cy9udmVyYmEvbWlzLWJ1dHRvbi9zcmMvanMvbWlzLWJ1dHRvbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7QUNFQSxDQUFDLFlBQVc7QUFBRSxhQUFZLENBQUM7O0FBR3pCLFNBQVEsQ0FBQyxNQUFNLEdBQUcsMERBQTBELENBQUM7QUFDN0UsVUFBUyxVQUFVLEdBQUc7QUFDcEIsVUFBUSxDQUFDLE1BQU0sR0FBQyxZQUFZLENBQUM7QUFDN0IsU0FBTyxRQUFRLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztFQUNwRDtBQUNELE1BQUssQ0FBQyxzQkFBc0IsR0FBRyxVQUFVLEVBQUUsQ0FBQyxDQUFDO0FBQzdDLFFBQU8sQ0FBQyxHQUFHLENBQUMsK0JBQStCLENBQUMsQ0FBQzs7QUFHOUMsS0FBSSxLQUFLLG9NQU9SLENBQUE7O0FBRUQsS0FBSSxNQUFNLHdFQUFvRSxDQUFDO0FBQy9FLEtBQUksT0FBTyxHQUFHLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0FBQ3JFLEtBQUksUUFBUSxHQUFHLEtBQUssQ0FBQTs7O0FBR3BCLEtBQUksU0FBUyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDOUMsVUFBUyxDQUFDLFNBQVMsR0FBRyxjQUFjLENBQUM7QUFDckMsU0FBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLENBQUM7OztBQUdyQyxLQUFJLFVBQVUsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQy9DLFdBQVUsQ0FBQyxTQUFTLEdBQUcsWUFBWSxDQUFDO0FBQ3BDLFNBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLFVBQVUs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QixDQUFDLE9BQU8sRUFBRSxhQUFhLENBQUMsQ0FBQztBQUNsRCxTQUFNLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQyxDQUFDOzs7QUFHaEQsU0FBTSxDQUFDLFlBQVksQ0FBQyxLQUFLLEVBQU0sTUFBTSxDQUFDLEdBQUcsb0JBQWlCLEdBQUcsQ0FBSSxDQUFDO0dBQ2xFOztBQUVELFFBQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDLENBQUM7RUFDOUM7Q0FFRCxDQUFBLEVBQUcsQ0FBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKiBnbG9iYWwgTUlTYnRuICovXG5cbihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG5cbiAgZG9jdW1lbnQuY29va2llID0gXCJzZXRDb29raWU9dHJ1ZSxwYXRoPS87ZG9tYWluPWNvbXBvbmVudHMubWFrZWl0c29jaWFsLmNvbVwiO1xuICBmdW5jdGlvbiB0ZXN0Q29va2llKCkge1xuICAgIGRvY3VtZW50LmNvb2tpZT1cInRlc3Rjb29raWVcIjtcbiAgICByZXR1cm4gZG9jdW1lbnQuY29va2llLmluZGV4T2YoXCJ0ZXN0Y29va2llXCIpICE9IC0xO1xuICB9XG4gIGFsZXJ0KCdCdXR0b24gY29va2llIHNldCAtICcgKyB0ZXN0Q29va2llKCkpO1xuICBjb25zb2xlLmxvZygnU2V0dGluZyBidXR0b24gc2Vzc2lvbiBjb29raWUnKTtcblxuXG5cdGxldCBwb3B1cCA9IGBcblx0XHQ8ZGl2IGNsYXNzPVwibWlzRnJhbWVcIj5cblx0XHRcdDxkaXYgY2xhc3M9XCJkcmFnaGFuZGxlXCI+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJtaXNJY28gbWlzTWluXCI+PC9kaXY+XG5cdFx0XHQ8L2Rpdj5cblx0XHQ8L2Rpdj5cblx0ICA8aWZyYW1lIGNsYXNzPVwiTWlTX1BvcFVwXCIgc3JjPVwiXCI+PC9pZnJhbWU+XG5cdGBcblx0XG5cdGxldCBzcHJpdGUgPSBgPGRpdiBjbGFzcz1cIm1pc0J0bkZpbGxcIj48ZGl2IGNsYXNzPVwibWlzSWNvIG1pc01heFwiPjwvZGl2PjwvZGl2PmA7XG5cdGxldCBidXR0b25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcIm1ha2VpdHNvY2lhbC1idXR0b25cIik7XG5cdGxldCBpc01vYmlsZSA9IGZhbHNlIC8vIG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWR8QmxhY2tCZXJyeXxpUGhvbmV8aVBhZHxpUG9kfE9wZXJhIE1pbml8SUVNb2JpbGUvaSk7XG5cdFxuXHQvLyBDcmVhdGUgJiBhcHBlbmQgdGhlIGNvbnRhaW5lciBmb3Igb3BlbmVkLCBtaW5pbWlzZWQgcG9wdXBzLlxuXHRsZXQgbWluaW1pc2VkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdG1pbmltaXNlZC5jbGFzc05hbWUgPSBcIm1pc01pbmltaXNlZFwiO1xuXHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1pbmltaXNlZCk7XG5cdFxuXHQvLyBEcmFnQ2FudmFzIGlzb2xhdGVzIHRoZSBwb3B1cHMgZnJvbSBhbnkgdW5kZXJseWluZyBpZnJhbWVzIHRoYXQgY2FuIGNhcHR1cmUgZHJvcCBldmVudHMsIGEgZHJhZyBldmVudCByZW1vdmVzIHRoZSB7IHBvaW50ZXItZXZlbnRzOiBub25lIH0gY2xhc3MgcHJvcGVydHkuIFxuXHRsZXQgZHJhZ2NhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRkcmFnY2FudmFzLmNsYXNzTmFtZSA9IFwiZHJhZ0NhbnZhc1wiO1xuXHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRyYWdjYW52YXMpO1xuXHRcblx0d2luZG93Lk1JU2J0biA9IHtcblx0XHRyZWdpc3RlcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcblx0XHRcdGxldCBidXR0b25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcIm1ha2VpdHNvY2lhbC1idXR0b25cIik7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFyIGJ1dHRvbiA9IGJ1dHRvbnNbaV07XG5cdFx0XHRcdGlmIChidXR0b24uZ2V0QXR0cmlidXRlKCdNaXNCdG5SZWcnKSkgeyByZXR1cm47IH1cblx0XHRcdFx0Y29uc29sZS5sb2coJ3JlZ2lzdGVyIGxpc3RlbmVyJywgYnV0dG9uKTtcblx0XHRcdFx0Y3JlYXRlQnV0dG9uKGJ1dHRvbnNbaV0pO1xuXHRcdFx0XHRidXR0b24uc2V0QXR0cmlidXRlKCdNaXNCdG5SZWcnLCB0cnVlKVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0dXJsOiAnaHR0cHM6Ly9wb3B1cC5tYWtlaXRzb2NpYWwuY29tLydcblx0fTtcblx0XG5cdGZ1bmN0aW9uIGNyZWF0ZUJ1dHRvbihidXR0b24pIHtcblx0XHRcblx0XHRsZXQgYWN0aXZlID0gZmFsc2U7XG5cdFx0bGV0IHBpZCA9IGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGlkJyk7XG5cdFx0bGV0IGNvb3JkcyA9IFsod2luZG93LmlubmVyV2lkdGggLyAyKSAtIDIwMCwgMjBdO1xuXHRcdGxldCBvZmZzZXQgPSBbMCwgMF07XG5cdFx0XG5cdFx0bGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFxuXHRcdGNvbnRhaW5lci5pbm5lckhUTUwgPSBwb3B1cDtcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCAndHJ1ZScpO1xuXHRcdGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ29uZHJhZ3N0YXJ0JywgXCJldmVudC5kYXRhVHJhbnNmZXIuc2V0RGF0YSgndGV4dC9wbGFpbicsICdUaGlzIHRleHQgbWF5IGJlIGRyYWdnZWQnKVwiKTsgLy8gZmlyZWZveCBkYXRhIHdvcmthcm91bmRcblx0XHRjb250YWluZXIuY2xhc3NOYW1lID0gXCJtaXNDb3ZlclwiO1xuXHRcdFxuXHRcdGxldCBsb2FkZXIgPSBjb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbWlzU3Bpbm5lcicpWzBdO1xuXHRcdGxldCBpZnJhbWUgPSBjb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnTWlTX1BvcFVwJylbMF07XG5cdFx0bGV0IG1pbmltaSA9IGNvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtaXNNaW4nKVswXTtcblx0XHRsZXQgY2FjaGVkUG9zO1xuXHRcdGxldCBpc01pbmltaXNlZDtcblx0XHRcblx0XHRsZXQgbWF4aW1pc2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcblx0XHRtYXhpbWlzZS5jbGFzc05hbWUgPSBcIm1pc0J0blwiO1xuXHRcdG1heGltaXNlLmlubmVySFRNTCA9IHNwcml0ZTtcblx0XHRtaW5pbWlzZWQuYXBwZW5kQ2hpbGQobWF4aW1pc2UpO1xuXHRcdFxuXHRcdGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VuZFwiLCBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRkcmFnY2FudmFzLmNsYXNzTmFtZSA9IFwiZHJhZ0NhbnZhc1wiO1xuXHRcdFx0dXBkYXRlUG9zKGNvb3Jkcyk7XG4gIFx0fSwgZmFsc2UpO1xuXHRcdFxuXHRcdGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdGRyYWdjYW52YXMuY2xhc3NOYW1lID0gXCJkcmFnQ2FudmFzIGFjdGl2ZURyYWdcIjtcblx0XHRcdG9mZnNldCA9IFtldmVudC5vZmZzZXRYLCBldmVudC5vZmZzZXRZXTtcbiAgXHR9LCBmYWxzZSk7XG5cdFx0XG5cdCAgZHJhZ2NhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdGNvb3JkcyA9IFtldmVudC5jbGllbnRYIC0gb2Zmc2V0WzBdLCBldmVudC5jbGllbnRZIC0gb2Zmc2V0WzFdXTtcblx0ICB9LCBmYWxzZSk7XG5cdFx0XG5cdCAgZHJhZ2NhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgIH0sIGZhbHNlKTtcblx0XHRcblx0XHRmdW5jdGlvbiB1cGRhdGVQb3MoYykge1xuXHRcdFx0Y29udGFpbmVyLnN0eWxlLmxlZnQgPSBjWzBdICsgJ3B4Jztcblx0XHRcdGNvbnRhaW5lci5zdHlsZS50b3AgPSBjWzFdICsgJ3B4Jztcblx0XHR9XG5cdFx0XG5cdFx0ZnVuY3Rpb24gbGF1bmNoUG9wdXAoZSkge1xuXHRcdFx0XG5cdFx0XHRpZiAoaXNNb2JpbGUpIHtcblx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSBgJHsgTUlTYnRuLnVybCB9Iy9zZXR1cD9waWQ9JHsgcGlkIH1gOyAgXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gT3BlbiBvbmx5IG9uZSBwb3B1cCBwZXIgYnV0dG9uO1xuXHRcdFx0aWYgKGFjdGl2ZSkge1xuXHRcdFx0XHRpZiAoaXNNaW5pbWlzZWQpIHsgbWF4aW1pc2VQb3B1cCgpOyB9XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0ZHJhZ2NhbnZhcy5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuXHRcdFx0dXBkYXRlUG9zKFsod2luZG93LmlubmVyV2lkdGggLyAyKSAtIDIwMCwgMjBdKTtcblx0XHRcdGFjdGl2ZSA9IHRydWU7XG5cdFx0XHRcblx0XHRcdC8vIGlmcmFtZS5vbmxvYWQgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHQvLyBcdC8vIEdpdmUgMXMgdG8gbGV0IHBhZ2UgcmVuZGVyIHdpdGggcHJvZHVjdCBkZXRhaWxzXG5cdFx0XHQvLyBcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBcdFx0bG9hZGVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0XHRcdC8vIFx0XHRpZnJhbWUuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcblx0XHRcdC8vIFx0fSwgMTAwMCk7XG5cdFx0XHQvLyB9O1xuXHRcdFx0XG5cdFx0XHRmdW5jdGlvbiBtaW5pbWlzZVBvcHVwKCkge1xuXHRcdFx0XHRjYWNoZWRQb3MgPSBbY29udGFpbmVyLm9mZnNldExlZnQsIGNvbnRhaW5lci5vZmZzZXRUb3BdO1xuXHRcdFx0XHRjb250YWluZXIuY2xhc3NOYW1lID0gXCJtaXNDb3ZlciBtaXNNb3ZlTWluIG1pc0FuaW1cIjtcblx0XHRcdFx0bWF4aW1pc2UuY2xhc3NOYW1lICA9IFwibWlzQnRuIG1pbWltaXNlZFwiO1xuXHRcdFx0XHR1cGRhdGVQb3MoW2RvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGggLSAzMDAsIHdpbmRvdy5pbm5lckhlaWdodCAtIDEwMF0pO1xuXHRcdFx0XHRpc01pbmltaXNlZCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGZ1bmN0aW9uIG1heGltaXNlUG9wdXAoKSB7XG5cdFx0XHRcdGNvbnRhaW5lci5jbGFzc05hbWUgPSBcIm1pc0NvdmVyIG1pc0FuaW1cIjtcblx0XHRcdFx0bWF4aW1pc2UuY2xhc3NOYW1lICA9IFwibWlzQnRuXCI7XG5cdFx0XHRcdHVwZGF0ZVBvcyhjYWNoZWRQb3MpO1xuXHRcdFx0XHRpc01pbmltaXNlZCA9IGZhbHNlO1xuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNvbnRhaW5lci5jbGFzc05hbWUgPSBcIm1pc0NvdmVyXCI7XG5cdFx0XHRcdH0sIDUwMCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGZ1bmN0aW9uIHJlY2VpdmVNZXNzYWdlKGV2ZW50KSB7XG5cdFx0XHRcdC8vIFRoaXMgY2hlY2sgaXMgZXNzZW50aWFsIHRvIGF2b2lkIHhzcywgdGhpcyBmZWF0dXJlIHBvcHVsYXRlcyB0aGUgbWF4aW1pc2UgYnV0dG9uIHRleHRcblx0XHRcdFx0aWYgKGV2ZW50Lm9yaWdpbiAhPT0gXCJodHRwczovL3BvcHVwLXNhbmRib3guaGVyb2t1YXBwLmNvbVwiICYmIGV2ZW50Lm9yaWdpbiAhPT0gXCJodHRwczovL3BvcHVwLm1ha2VpdHNvY2lhbC5jb21cIikgeyByZXR1cm47IH1cblx0XHRcdFx0dmFyIGRhdGEgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpO1xuXHRcdFx0XHRpZiAoZGF0YS5waWQgPT09IHBpZCkge1xuXHRcdFx0XHRcdG1heGltaXNlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGRhdGEubmFtZSkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIHJlY2VpdmVNZXNzYWdlLCBmYWxzZSk7XG5cdFx0XHRtYXhpbWlzZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG1heGltaXNlUG9wdXApO1xuXHRcdFx0bWluaW1pLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbWluaW1pc2VQb3B1cCk7XG5cdFx0XHQvLyB1c2VkIGZvciBsb2NhbCB0ZXN0aW5nXG5cdFx0XHQvLyBpZnJhbWUuc2V0QXR0cmlidXRlKCdzcmMnLCBcImh0dHA6Ly8xMjcuMC4wLjE6ODA4MC8jL3NldHVwP3BpZD1cIiArIHBpZCk7ICAgXG5cdFx0XHRpZnJhbWUuc2V0QXR0cmlidXRlKCdzcmMnLCBgJHsgTUlTYnRuLnVybCB9Iy9zZXR1cD9waWQ9JHsgcGlkIH1gKTtcblx0XHR9XG5cdFx0XG5cdFx0YnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbGF1bmNoUG9wdXApO1xuXHR9XG5cdFxufSkoKSJdfQ==
